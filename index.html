<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AR Chair Viewer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Three.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r129/three.min.js"></script>
    
    <!-- WebXR Polyfill for non-supporting browsers -->
    <script src="https://cdn.jsdelivr.net/npm/three.xr.js"></script>
</head>
<body style="margin: 0;">
    <!-- WebGL canvas container -->
    <div id="ar-view"></div>
    
    <!-- JavaScript code for AR scene setup -->
    <script>
        // Define global variables
        let scene, camera, renderer;
        let arButton;
        let controller;

        // Function to initialize the AR scene
        function init() {
            // Create a Three.js scene
            scene = new THREE.Scene();

            // Create a perspective camera
            camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 10);

            // Create a WebGL renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.getElementById('ar-view').appendChild(renderer.domElement);

            // Add ambient light to the scene
            const ambientLight = new THREE.AmbientLight(0xffffff, 1);
            scene.add(ambientLight);

            // Load the GLB model
            const loader = new THREE.GLTFLoader();
            loader.load('models/chair.glb', function (gltf) {
                const model = gltf.scene;
                model.scale.set(0.1, 0.1, 0.1); // Scale the model as needed
                scene.add(model);
            });

            // Initialize WebXR
            const xrButton = new THREE.XRControllerButton(renderer);
            xrButton.addEventListener('connected', function (event) {
                controller = event.detail;
                scene.add(controller);
            });

            // Set up WebXR session
            const button = new THREE.XRButton(renderer);
            button.addEventListener('selectstart', function () {
                if (controller) controller.userData.select();
            });

            // Handle resize events
            window.addEventListener('resize', onWindowResize, false);
        }

        // Function to handle window resize
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        // Function to animate the scene
        function animate() {
            renderer.setAnimationLoop(render);
        }

        // Function to render the scene
        function render() {
            renderer.render(scene, camera);
        }

        // Initialize the AR scene
        init();
        animate();
    </script>
</body>
</html>
